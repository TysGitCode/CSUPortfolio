## COBRA Eligibility & Event Processing Pipeline

**SQL + Python | HR & Benefits Data Engineering**

### Project Summary

Built an automated pipeline to generate **vendor‑compliant COBRA eligibility files** from HR, benefits, and dependent data. The solution replaces manual processing with **deterministic SQL logic** and **Python‑based validation/cleaning**, ensuring regulatory accuracy and repeatable outbound delivery.

***

### What Makes This Project Strong

*   **Advanced SQL orchestration** using layered CTEs, window functions, and conditional logic
*   Translation of **complex COBRA business rules** into auditable, testable queries
*   Creation of **synthetic benefit plans** (EAP, Tobacco Surcharge) driven entirely by eligibility logic
*   Defensive data handling to prevent vendor rejections and compliance errors

***

### Key Technical Highlights

**1. Record Ranking & Source‑of‑Truth Selection**

*   Used `ROW_NUMBER()` window functions to reliably select the **most recent valid** employee, contact, and benefit records per individual.
*   Prevented duplicate or stale data from leaking into the outbound file.

**2. Synthetic Plan Generation**

*   Automatically generated:
    *   **EAP coverage** for all qualifying employees
    *   **Tobacco Surcharge (SMKR)** plans *only* when eligibility conditions were met
*   Implemented prioritization logic to resolve conflicts between real and synthetic benefit rows.

**3. COBRA Event Logic**

*   Correctly identified and classified:
    *   Termination, retirement, and death events
    *   **Age‑26 dependent aging‑out events**, including year‑boundary edge cases
*   Calculated precise event and coverage end dates required by COBRA vendors.

**4. Vendor‑Safe Python Cleansing**

*   Finalized SQL output with Python to:
    *   Preserve SSNs and identifiers as strings
    *   Enforce strict column ordering
    *   Normalize nulls and whitespace
    *   Export a **text‑based CSV** safe from Excel corruption

***

### Technologies Used

*   **SQL** (CTEs, window functions, conditional logic)
*   **Python** (pandas for validation and export hygiene)
*   HR / Benefits data models (employees, dependents, coverage, eligibility)

***

### Why This Matters

COBRA files are **legally sensitive** and vendor‑strict. This project demonstrates the ability to:

*   Convert ambiguous policy rules into precise logic
*   Build data pipelines that are **accurate, explainable, and production‑ready**
*   Own a problem end‑to‑end from raw data to external delivery

***
